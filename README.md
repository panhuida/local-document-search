<h1 align="center">ğŸ”æœ¬åœ°æ–‡æ¡£æœç´¢åŠ©æ‰‹</h1>

<p align="center">
  <strong>å°†æœ¬åœ°æ–‡æ¡£ã€æ€ç»´å¯¼å›¾ã€Joplinã€å›¾ç‰‡çš„å†…å®¹æå–è½¬æ¢æˆ Markdown å¹¶åˆ›å»ºç´¢å¼•è¿›è¡Œæ£€ç´¢</strong>
</p>

<p align="center">
  <img src="docs\assets\ui.png" alt="ä¸»ç•Œé¢">
</p>

**æ³¨ï¼šè¿™ä¸ªé¡¹ç›®çš„ä»£ç ç”± AI ç”Ÿæˆï¼ŒREADME æ–‡æ¡£ä¹Ÿä¸»è¦ç”± AI ç”Ÿæˆã€‚**





## ä¸»è¦åŠŸèƒ½

- **ğŸ“ æ–‡ä»¶å¤¹æ‰«æ**ï¼šé€’å½’æ‰«ææœ¬åœ°æ–‡ä»¶å¤¹ï¼Œå¯æ ¹æ®ä¿®æ”¹æ—¶é—´ / æ–‡ä»¶ç±»å‹åšå¢é‡æˆ–å…¨é‡ç´¢å¼•ã€‚
- **ğŸ“„ æ”¯æŒå¸¸è§çš„æ–‡æ¡£**ï¼šPDFã€Word (`.docx`, `.doc` ) ã€PPT (`.pptx`, `.ppt`)  ã€Excel (`.xlsx` , `.xls`)  ã€‚
- **ğŸ—ºï¸ æ”¯æŒæ€ç»´å¯¼å›¾ä¸æµç¨‹å›¾**ï¼šXMindã€draw.io ã€‚
- **âœï¸ Joplin ç¬”è®°åŒæ­¥**ï¼šé€šè¿‡è„šæœ¬ä»æœ¬åœ° Joplin åº”ç”¨çš„ API åŒæ­¥ç¬”è®° ã€‚
- **ğŸ§  å¤šæ¨¡æ€å¢å¼º**ï¼šå›¾ç‰‡ â†’ æœ¬åœ° OCR / LLM è¯­ä¹‰æè¿°ï¼ˆå¯é“¾å¼é™çº§ Providerï¼‰ï¼Œå†™å…¥ Front Matterï¼›å¯æ‰©å±•è§†é¢‘å­—å¹•ã€å…³é”®å¸§è§£æã€‚
- **ğŸ¬ è§†é¢‘å…ƒæ•°æ®æå–**ï¼šæŠ½å–å…ƒæ•°æ®å½¢æˆ Markdownï¼Œåç»­å¯æ¥å…¥å­—å¹•/ç« èŠ‚/æ‘˜è¦ã€‚
- **ğŸš€ é«˜æ€§èƒ½å…¨æ–‡æ£€ç´¢**ï¼šåˆ©ç”¨ PostgreSQL **PGroonga** æ‰©å±•ï¼Œä¸ºæ–‡æ¡£å†…å®¹å’Œæ–‡ä»¶åæä¾›é«˜é€Ÿã€ç²¾å‡†çš„å…¨æ–‡æœç´¢èƒ½åŠ›ã€‚
- **âœï¸ æ¨¡ç³Šæ£€ç´¢**ï¼šåˆ©ç”¨PostgreSQL  **pg_trgm** æ‰©å±•ï¼Œæ”¯æŒæ–‡ä»¶åå’Œå†…å®¹çš„ trigram æ¨¡ç³ŠåŒ¹é…ï¼Œå³ä½¿æœ‰æ‹¼å†™é”™è¯¯ä¹Ÿèƒ½æ‰¾åˆ°ç›¸å…³ç»“æœã€‚
- **ğŸ–¥ï¸ ç®€æ´æ˜“ç”¨çš„ Web ç•Œé¢**ï¼š
    - æä¾›æ¸…æ™°çš„æœç´¢é¡µé¢ï¼Œæ”¯æŒå…³é”®è¯æœç´¢ã€‚
    - æœç´¢ç»“æœåˆ—è¡¨ä¼šç”ŸæˆåŒ…å«å…³é”®è¯çš„**å†…å®¹æ‘˜è¦**å¹¶**é«˜äº®**æ˜¾ç¤ºã€‚
    - æ”¯æŒç‚¹å‡»æ–‡ä»¶åé¢„è§ˆå®Œæ•´çš„ Markdown å†…å®¹ã€‚
    - æ”¯æŒä»æœç´¢ç»“æœä¸­ç›´æ¥è°ƒç”¨ç³»ç»Ÿé»˜è®¤ç¨‹åºæ‰“å¼€æœ¬åœ°çš„åŸå§‹æ–‡ä»¶ã€‚





## æŠ€æœ¯æ ˆ

- **åç«¯**: Python 3, Flask, SQLAlchemy
- **æ•°æ®åº“**: PostgreSQL
- **æ•°æ®åº“æ‰©å±•**: PGroonga (å…¨æ–‡æ£€ç´¢), pg_trgm (æ¨¡ç³Šæ£€ç´¢)
- **å‰ç«¯**: åŸç”Ÿ HTML, CSS, JavaScript 
- **æ ¸å¿ƒä¾èµ–**: 
    - `psycopg2-binary`: PostgreSQL é©±åŠ¨ã€‚
    - `markitdown[all]`: å¼ºå¤§çš„å¤šæ ¼å¼æ–‡ä»¶è½¬ Markdown å·¥å…·ã€‚
    - `python-dotenv`: ç”¨äºç®¡ç†ç¯å¢ƒå˜é‡ã€‚
    - `requests`: ç”¨äº API è¯·æ±‚ã€‚





## å®‰è£…ä¸è®¾ç½®

### 1. ç¯å¢ƒå‡†å¤‡

- Windows 11

- ç¡®ä¿æ‚¨å·²ç»å®‰è£…äº† Python 3.12+ å’Œ Git
- å®‰è£…å¹¶è¿è¡Œ **PostgreSQL** (å»ºè®®ç‰ˆæœ¬ 16+)



### 2. å…‹éš†ä¸å®‰è£…ä¾èµ–

æœ¬é¡¹ç›®ä½¿ç”¨ `uv` è¿›è¡Œä¾èµ–ç®¡ç†ã€‚

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <your-repository-url>
cd local_document_search

# 2. å®‰è£… uv (å¦‚æœå°šæœªå®‰è£…)
# Windows (PowerShell)
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
# macOS/Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# 3. åŒæ­¥ä¾èµ–ç¯å¢ƒ
# è¿™å°†æ ¹æ® uv.lock æ–‡ä»¶å®‰è£…æ‰€æœ‰ä¾èµ–å¹¶è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
uv sync

# å¦‚éœ€ä½¿ç”¨ pip å®‰è£…ï¼ˆå¤‡é€‰æ–¹æ¡ˆï¼‰
# å»ºè®®å…ˆåˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼Œå†å®‰è£…ï¼š
pip install -r requirements.txt
```



### 3. é…ç½®ç¯å¢ƒå˜é‡

é¡¹ç›®ä½¿ç”¨ `.env` æ–‡ä»¶ç®¡ç†é…ç½®ã€‚æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶ `.env.example`ã€‚

```bash
# 1. ä»æ¨¡æ¿å¤åˆ¶é…ç½®æ–‡ä»¶
# Windows
copy .env.example .env
# macOS/Linux
cp .env.example .env

# 2. ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè‡³å°‘ä¿®æ”¹ä»¥ä¸‹ä¸¤é¡¹ï¼š
#    - DATABASE_URL: ä¿®æ”¹ä¸ºæ‚¨è‡ªå·±çš„æ•°æ®åº“ç”¨æˆ·åã€å¯†ç å’Œåº“åã€‚
#    - JOPLIN_API_TOKEN: å¡«å…¥æ‚¨ä» Joplin è·å–çš„ API ä»¤ç‰Œã€‚
```



### 4. é…ç½®æ•°æ®åº“

- åœ¨ PostgreSQL ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“ï¼ˆä¾‹å¦‚ï¼Œ`document_search`ï¼‰ã€‚
- è¿æ¥åˆ°æ‚¨åˆšåˆ›å»ºçš„æ•°æ®åº“ï¼Œå¹¶å¯ç”¨ `pg_trgm` å’Œ `pgroonga` æ‰©å±•ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ `psql` æˆ–ä»»ä½•å›¾å½¢åŒ–å·¥å…·æ‰§è¡Œä»¥ä¸‹ SQL å‘½ä»¤ï¼š
  ```sql
  CREATE EXTENSION IF NOT EXISTS pg_trgm;
  CREATE EXTENSION IF NOT EXISTS pgroonga;
  ```
  > **é‡è¦**: PGroonga å¯èƒ½éœ€è¦å•ç‹¬å®‰è£…ã€‚è¯·å‚è€ƒ [PGroonga å®˜æ–¹å®‰è£…æ–‡æ¡£](https://pgroonga.github.io/install/) å®Œæˆåœ¨æ‚¨æ“ä½œç³»ç»Ÿä¸Šçš„å®‰è£…ã€‚



### 5. åˆå§‹åŒ–æ•°æ®åº“

åœ¨ PostgreSQL ä¸­åˆ›å»ºæ•°æ®è¡¨ã€‚

#### æ–‡æ¡£æœç´¢æ•°æ®è¡¨

**alembic_version  Flask-Migrate ç‰ˆæœ¬è¡¨**

```sql
CREATE TABLE public.alembic_version (
	version_num varchar(32) NOT NULL,
	CONSTRAINT alembic_version_pkc PRIMARY KEY (version_num)
);
```

**ingest_state  åŒæ­¥çŠ¶æ€è¡¨**

```sql
CREATE TABLE public.ingest_state (
	id serial4 NOT NULL,
	"source" varchar(30) NOT NULL,
	scope_key text NOT NULL,
	last_started_at timestamptz NULL,
	last_ended_at timestamptz NULL,
	last_error_message text NULL,
	cursor_updated_at timestamptz NULL,
	total_files int4 NULL,
	processed int4 NULL,
	skipped int4 NULL,
	errors int4 NULL,
	created_at timestamptz DEFAULT now() NULL,
	updated_at timestamptz NULL,
	CONSTRAINT ingest_state_pkey PRIMARY KEY (id)
);
CREATE UNIQUE INDEX idx_ingest_state_source_scope ON public.ingest_state USING btree (source, scope_key);
```

**documents æ–‡æ¡£è®°å½•è¡¨**

```sql
CREATE TABLE public.documents (
	id serial4 NOT NULL,
	file_name varchar(200) NOT NULL,
	file_type varchar(10) NULL,
	file_size int8 NULL,
	file_created_at timestamptz NULL,
	file_modified_time timestamptz NULL,
	file_path text NOT NULL,
	markdown_content text NULL,
	conversion_type int4 NULL,
	status varchar(10) NULL,
	error_message text NULL,
	created_at timestamptz DEFAULT now() NULL,
	updated_at timestamptz NULL,
	"source" varchar(30) NULL,
	source_url text NULL,
	CONSTRAINT documents_file_path_key UNIQUE (file_path),
	CONSTRAINT documents_pkey PRIMARY KEY (id)
);
CREATE UNIQUE INDEX idx_documents_file_path ON public.documents USING btree (file_path);
CREATE INDEX idx_documents_file_name_gin ON public.documents USING gin (file_name gin_trgm_ops);
CREATE INDEX idx_documents_markdown_content_gin ON public.documents USING gin (markdown_content gin_trgm_ops);
CREATE INDEX idx_pgroonga_markdown_content ON public.documents USING pgroonga (markdown_content);
CREATE INDEX ix_documents_source ON public.documents USING btree (source);
```



### 6. é…ç½® æœ¬åœ° Tailwind CSSï¼ˆå¯é€‰ï¼‰

æ— éœ€ npmï¼Œä½¿ç”¨å®˜æ–¹ç‹¬ç«‹äºŒè¿›åˆ¶ï¼ˆå·²æ”¾åœ¨é¡¹ç›®æ ¹ï¼‰ã€‚

https://github.com/tailwindlabs/tailwindcss/discussions/15855

1) ä¸‹è½½ Tailwind

- åœ°å€ï¼šhttps://github.com/tailwindlabs/tailwindcss/releases/

- æ”¾ç½® `tailwindcss.exe` é¡¹ç›®æ ¹ç›®å½•ã€‚

2) è¾“å…¥æ ·å¼æ–‡ä»¶

- è·¯å¾„ï¼š [src/local_document_search/static/src/in.css](src/local_document_search/static/src/in.css)
- å†…å®¹æ ¸å¿ƒï¼š`@import "tailwindcss" source("../../..");` ï¼›å¦‚éœ€ç¦ç”¨é¢„è®¾ baseï¼Œå¯æŒ‰æ–‡ä»¶ä¸­æ³¨é‡Šæ›¿æ¢ã€‚

3) ç”Ÿæˆäº§ç‰©

- ç›®å½•ï¼š [src/local_document_search/static/dist/](src/local_document_search/static/dist)

- ä¸€æ¬¡æ„å»ºï¼ˆå‹ç¼©ï¼‰ï¼š

  ```powershell
  .\tailwindcss.exe -i .\src\local_document_search\static\src\in.css \
    -o .\src\local_document_search\static\dist\main.css --minify
  ```

- å¼€å‘ç›‘å¬ï¼šå‘½ä»¤æœ«å°¾æ”¹ä¸º `--watch`ï¼ˆå¯å»æ‰ `--minify`ï¼‰ã€‚

4) æ¨¡æ¿å¼•ç”¨

- å·²åœ¨ [src/local_document_search/templates/base.html](src/local_document_search/templates/base.html#L6-L7) ä½¿ç”¨ `{{ url_for('static', filename='dist/main.css') }}`ã€‚

5) ç‰ˆæœ¬æŸ¥çœ‹

- `./tailwindcss.exe --version`ï¼ˆå½“å‰ä½¿ç”¨ v4.1.18ï¼‰ã€‚

6) Git å¿½ç•¥

- `.gitignore` å·²å¿½ç•¥ `tailwindcss.exe` ä¸ `src/local_document_search/static/dist/`ã€‚

7) æœ¬åœ° / CDN åˆ‡æ¢

- æ¨¡æ¿å·²é»˜è®¤ä½¿ç”¨æœ¬åœ°æ„å»º CSSï¼š`{{ url_for('static', filename='dist/main.css') }}`ã€‚
- è‹¥æƒ³æ”¹ç”¨ CDNï¼ˆå¿«é€Ÿè¯•ç”¨ï¼‰ï¼šåœ¨ [src/local_document_search/templates/base.html](src/local_document_search/templates/base.html#L6-L8) æ³¨é‡Šæœ¬åœ°é“¾æ¥ï¼Œå¯ç”¨æ³¨é‡Šç¤ºä¾‹ `<script src="https://cdn.tailwindcss.com"></script>`ã€‚



### 7. å¯åŠ¨ Web åº”ç”¨

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œï¼š

```bash
uv run run.py
```

æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® `http://127.0.0.1:5000`ã€‚

æˆ–ä½¿ç”¨æ–°å¢å…¥å£ï¼ˆæ›´è´´è¿‘å¸¸è§„ Flask å¯åŠ¨æ–¹å¼ï¼‰ï¼š

```bash
python run.py
```

### 7. å‘½ä»¤è¡Œ CLIï¼ˆconversion è¯•ç‚¹ï¼‰

> ä¾èµ– click å·²åŠ å…¥ requirements.txtã€‚

è½¬æ¢å•ä¸ªæ–‡ä»¶ä¸º Markdownï¼ˆé»˜è®¤è¾“å‡ºåˆ° stdoutï¼Œå¯ç”¨ -o å†™å…¥æ–‡ä»¶ï¼‰ï¼š

```bash
python -m local_document_search.cli convert-file /path/to/file.pdf -o out.md
# æˆ–æŒ‡å®šæ–‡ä»¶ç±»å‹ï¼ˆé»˜è®¤è‡ªåŠ¨æ ¹æ®æ‰©å±•åï¼‰
python -m local_document_search.cli convert-file /path/to/file --file-type pdf
```

æ‰¹é‡è½¬æ¢ç›®å½•ï¼ˆä¿ç•™ç›®å½•ç»“æ„ï¼Œè¾“å‡º .md åˆ°ç›®æ ‡ç›®å½•ï¼‰ï¼š

```bash
python -m local_document_search.cli convert-dir /path/to/src -o /path/to/out \
  --extensions pdf,docx,md,txt --recursive
```
ä¸æŒ‡å®š --extensions æ—¶é»˜è®¤ä½¿ç”¨ Config.SUPPORTED_FILE_TYPESã€‚







## é¡¹ç›®ç»“æ„

```
local_document_search/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ local_document_search/  # æºä»£ç æ ¹ç›®å½•
â”‚       â”œâ”€â”€ routes/             # è·¯ç”±è“å›¾ (è§†å›¾å‡½æ•°)
â”‚       â”œâ”€â”€ services/           # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ (æ–‡ä»¶æ‰«æ, è½¬æ¢, æœç´¢)
â”‚       â”œâ”€â”€ static/             # é™æ€æ–‡ä»¶
â”‚       â”œâ”€â”€ templates/          # HTML æ¨¡æ¿
â”‚       â”œâ”€â”€ utils/              # è¾…åŠ©å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ __init__.py         # åº”ç”¨å·¥å‚å‡½æ•°
â”‚       â”œâ”€â”€ config.py           # é…ç½®æ–‡ä»¶
â”‚       â””â”€â”€ models.py           # SQLAlchemy æ•°æ®æ¨¡å‹
â”œâ”€â”€ logs/               	    # è¿è¡Œæ—¥å¿—
â”œâ”€â”€ migrations/                 # Flask-Migrate æ•°æ®åº“è¿ç§»è„šæœ¬
â”œâ”€â”€ scripts/                    # è¾…åŠ©è„šæœ¬ (å¦‚ Joplin å¯¼å…¥)
â”œâ”€â”€ tests/                      # å•å…ƒæµ‹è¯•
â”œâ”€â”€ .env                        # ç¯å¢ƒå˜é‡ (éœ€ä» .env.example å¤åˆ¶åˆ›å»º)
â”œâ”€â”€ .env.example                # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ pyproject.toml              # é¡¹ç›®é…ç½®ä¸ä¾èµ–ç®¡ç†
â”œâ”€â”€ uv.lock                     # ä¾èµ–ç‰ˆæœ¬é”å®šæ–‡ä»¶
â””â”€â”€ run.py                      # åº”ç”¨å¯åŠ¨å…¥å£
```





## å…¶å®ƒä¿¡æ¯

### 1. åŒæ­¥ Joplin ç¬”è®°

æ­¤åŠŸèƒ½é€šè¿‡å‘½ä»¤è¡Œè„šæœ¬æ‰§è¡Œã€‚

**å‡†å¤‡å·¥ä½œ:**

1.  ç¡®ä¿æ‚¨å·²åœ¨ `.env` æ–‡ä»¶ä¸­æ­£ç¡®é…ç½® `JOPLIN_API_TOKEN`ã€‚
2.  ç¡®ä¿æ‚¨çš„ Joplin æ¡Œé¢åº”ç”¨æ­£åœ¨è¿è¡Œï¼Œå¹¶ä¸” Web Clipper æœåŠ¡å·²å¼€å¯ (`å·¥å…·` -> `é€‰é¡¹` -> `Web Clipper`)ã€‚

**æ‰§è¡ŒåŒæ­¥:**

- **å¢é‡åŒæ­¥** (æ¨èï¼ŒåªåŒæ­¥ä¸Šæ¬¡åŒæ­¥åæœ‰æ›´æ–°çš„ç¬”è®°):

  ```shell
  python scripts/import_joplin.py
  ```

- **å…¨é‡åŒæ­¥** (å¼ºåˆ¶é‡æ–°åŒæ­¥æ‰€æœ‰ç¬”è®°):

  ```shell
  python scripts/import_joplin.py --full
  ```



### 2. å›¾ç‰‡æè¿° Provider é“¾å¼é™çº§

æ”¯æŒä¸ºå›¾ç‰‡è¯­ä¹‰æè¿°é…ç½®å¤š provider é™çº§é“¾ã€‚ä¾‹å¦‚ï¼š

```
IMAGE_CAPTION_PROVIDER=google-genai
IMAGE_PROVIDER_CHAIN=openai,google-genai,local
```

æ‰§è¡Œé¡ºåºï¼šæŒ‰ç…§ `IMAGE_PROVIDER_CHAIN` é¡ºåºé€ä¸ªå°è¯•ï¼›è‹¥é“¾ä¸ºç©ºï¼Œåˆ™ä»…ä½¿ç”¨ `IMAGE_CAPTION_PROVIDER`ã€‚è‹¥ `IMAGE_CAPTION_PROVIDER` ä¸åœ¨é“¾ä¸­ï¼Œä¼šè¢«è‡ªåŠ¨æ’å…¥åˆ°é“¾é¦–ï¼Œç¡®ä¿é¦–é€‰ä¼˜å…ˆã€‚

æ—¥å¿—ç¤ºä¾‹ï¼š

```
[ProviderFallback] attempt=1 provider=openai mode=llm file=img1.png
[ProviderFallback] failed attempt=1 provider=openai error=...OpenAIError...
[ProviderFallback] attempt=2 provider=google-genai mode=llm file=img1.png
```

å…¨éƒ¨å¤±è´¥æ—¶ï¼š

```
[ProviderFallback] all_failed file=img1.png errors=provider=openai error=...; provider=google-genai error=...
```

æç¤ºï¼šå°† `local` ç½®äºé“¾æœ«å¯åœ¨å¤–éƒ¨ API ä¸å¯ç”¨æ—¶ä»å›é€€åˆ°æœ¬åœ° OCRï¼ˆè‹¥å®‰è£…äº† Pillow + pytesseractï¼‰ã€‚



### 3. é…ç½®é¡¹é€Ÿè§ˆï¼ˆèŠ‚é€‰ï¼‰

| å˜é‡                        | è¯´æ˜                                                | é»˜è®¤                     |
| --------------------------- | --------------------------------------------------- | ------------------------ |
| `DATABASE_URL`              | PostgreSQL è¿æ¥ä¸²                                   | -                        |
| `LOG_LEVEL`                 | æ—¥å¿—ç­‰çº§                                            | INFO                     |
| `LOG_TIME_FORMAT`           | æ—¥å¿—æ—¶é—´æ ¼å¼                                        | `%Y-%m-%d %H:%M:%S`      |
| `IMAGE_CAPTION_PROVIDER`    | å›¾ç‰‡æè¿° Provider (`local`/`openai`/`google-genai`) | `google-genai`           |
| `IMAGE_PROVIDER_CHAIN`      | Provider é™çº§é“¾ï¼Œé€—å·åˆ†éš”                           | ç©º                       |
| `ENABLE_IMAGE_FRONT_MATTER` | æ˜¯å¦å†™å…¥å›¾ç‰‡ Front Matter                           | true                     |
| `TESSERACT_LANG`            | æœ¬åœ° OCR è¯­è¨€åŒ…                                     | `chi_sim+eng`            |
| `JOPLIN_API_TOKEN`          | Joplin API Token                                    | -                        |
| `JOPLIN_API_URL`            | Joplin API åŸºç¡€åœ°å€                                 | `http://localhost:41184` |

> æ›´å¤šè¯·æŸ¥çœ‹ `app/config.py`ã€‚



### 4. éƒ¨ç½²åˆ° Ubuntu 24.04 çš„æ³¨æ„äº‹é¡¹

åœ¨ Ubuntu Server æˆ–å…¶ä»– Linux ç¯å¢ƒä¸­éƒ¨ç½²æœ¬é¡¹ç›®æ—¶ï¼Œå¸¸è§é—®é¢˜æ˜¯æŸäº›ä¾èµ–åœ¨ Windows ä¸Šå¯ç”¨ï¼ˆä¾‹å¦‚ `pywin32`ã€Windows COM è‡ªåŠ¨åŒ–ï¼‰æˆ–è€…éœ€è¦ GUI æ”¯æŒçš„åº“ï¼ˆä¾‹å¦‚ `tkinter`ï¼‰åœ¨æ— å¤´æœåŠ¡å™¨ä¸Šä¸å¯ç”¨ã€‚ä¸‹é¢æ˜¯å»ºè®®çš„å¤„ç†æ–¹å¼ï¼š

- pywin32
  - `pywin32` ä»…åœ¨ Windows å¹³å°ä¸Šå¯ç”¨ã€‚æœ¬é¡¹ç›®åœ¨ `requirements.txt` ä¸­å°† `pywin32` æ ‡è®°ä¸ºä»…åœ¨ Windows ä¸Šå®‰è£…ï¼ˆç¯å¢ƒæ ‡è®°ï¼š`pywin32; sys_platform == "win32"`ï¼‰ã€‚åœ¨ Ubuntu ä¸Šæ— éœ€å®‰è£…è¯¥åŒ…ã€‚
  - åœ¨ä»£ç ä¸­ï¼Œå½“åœ¨ Windows å¹³å°å¹¶ä¸” `pywin32` å¯ç”¨æ—¶ï¼Œé¡¹ç›®ä¼šä½¿ç”¨ Windows COMï¼ˆWord/PowerPointï¼‰è¿›è¡Œ `.doc` / `.ppt` ç­‰è€æ ¼å¼çš„è½¬æ¢ï¼›å¦åˆ™ä¼šå›é€€åˆ°ä½¿ç”¨ LibreOfficeï¼ˆsofficeï¼‰ä»¥ headless æ¨¡å¼æ‰§è¡Œè½¬æ¢ã€‚

- tkinter
  - `tkinter` é€šå¸¸ç”¨äºæ‰“å¼€æœ¬åœ°æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼ˆä»…é€‚åˆæœ‰å›¾å½¢ç•Œé¢çš„æ¡Œé¢ç¯å¢ƒï¼‰ã€‚åœ¨æ— å¤´çš„ Ubuntu æœåŠ¡å™¨ä¸Šï¼Œ`tkinter` å¯èƒ½ä¸å¯ç”¨æˆ–æ— æ³•è¿è¡Œã€‚é¡¹ç›®ä¸­å·²å®ç°æ‡’åŠ è½½å¹¶åœ¨ç¼ºå°‘ `tkinter` æ—¶è¿”å›å‹å¥½çš„é”™è¯¯ï¼Œå»ºè®®åœ¨æœåŠ¡å™¨éƒ¨ç½²æ—¶é€šè¿‡ API ç›´æ¥ä¼ å…¥ç›®å½•è·¯å¾„ï¼ˆ`folder_path` å‚æ•°ï¼‰è€Œä¸æ˜¯ä¾èµ–æµè§ˆå¯¹è¯æ¡†ã€‚
  - å¦‚æœç¡®å®éœ€è¦åœ¨ Ubuntu æ¡Œé¢ç¯å¢ƒä¸­ä½¿ç”¨ GUIï¼Œå¯ä»¥å®‰è£…ï¼š
    ```bash
    sudo apt update
    sudo apt install -y python3-tk
    ```

- LibreOffice headlessï¼ˆæ¨èåœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œæ–‡ä»¶æ ¼å¼è½¬æ¢ï¼‰
  - åœ¨æ²¡æœ‰ Windows COM æ”¯æŒçš„ Linux ç³»ç»Ÿä¸Šï¼Œå®‰è£… LibreOffice å¹¶ç¡®ä¿ `soffice` åœ¨ PATH ä¸­ï¼Œé¡¹ç›®ä¼šä½¿ç”¨ `soffice --headless --convert-to ...` æ‰§è¡Œæ ¼å¼è½¬æ¢ã€‚
  - åœ¨ Ubuntu 24.04 ä¸Šå®‰è£… LibreOfficeï¼š
    ```bash
    sudo apt update
    sudo apt install -y libreoffice
    ```

- è¿è¡Œæ—¶å»ºè®®
  - åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œæ—¶ï¼Œä¼˜å…ˆé€šè¿‡ API æä¾› `folder_path` å‚æ•°ï¼Œé¿å…è§¦å‘ä»»ä½• GUI ç›¸å…³ä»£ç è·¯å¾„ã€‚
  - ç¡®ä¿åœ¨éƒ¨ç½²å‰ç”¨ `pip install -r requirements.txt` å®‰è£…ä¾èµ–ï¼ˆæ³¨æ„ `pywin32` åœ¨ Linux ä¸Šä¸ä¼šå®‰è£…ï¼‰ã€‚
  - å¦‚æœéœ€è¦è‡ªåŠ¨åŒ–å°†å¤§é‡ Office è€æ ¼å¼è½¬æ¢ä¸ºç°ä»£æ ¼å¼ï¼ˆä¾‹å¦‚ `.doc` -> `.docx`ï¼‰ï¼Œå»ºè®®åœ¨æœåŠ¡å™¨ä¸Šå®‰è£… LibreOfficeï¼Œå¹¶æ ¹æ®éœ€è¦é¢„å…ˆæµ‹è¯• `soffice --headless --convert-to docx filename.doc` çš„è¡Œä¸ºã€‚
